

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Serial Jobs &mdash; Aalto scientific computing</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
  

  
    <link rel="top" title="Aalto scientific computing" href="../../index.html"/>
        <link rel="up" title="Triton user guide" href="../index.html"/>
        <link rel="next" title="Array jobs" href="array.html"/>
        <link rel="prev" title="Interactive jobs" href="interactive.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Aalto scientific computing
          

          
            
            <img src="../../_static/aalto.png" class="logo" />
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../aalto/welcomeresearchers.html">Welcome, researchers!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../aalto/welcomestudents.html">Welcome, students!</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../news/index.html">News</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../aalto/index.html">The Aalto environment</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../data/index.html">Data</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Triton user guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#quick-contents-and-links">Quick contents and links</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#overview">Overview</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#tutorials">Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="intro.html">About Science-IT and Triton</a></li>
<li class="toctree-l3"><a class="reference internal" href="connecting.html">Connecting to Triton</a></li>
<li class="toctree-l3"><a class="reference internal" href="applications.html">Applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="modules.html">Software Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="storage.html">Data storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="interactive.html">Interactive jobs: running your first command</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="">Serial jobs: running in the queue</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#a-basic-script">A basic script</a></li>
<li class="toctree-l4"><a class="reference internal" href="#full-slurm-reference">Full slurm reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="#status-of-the-jobs">Status of the jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#partitions">Partitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exercises">Exercises</a></li>
<li class="toctree-l4"><a class="reference internal" href="#next-steps">Next steps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="array.html">Array jobs</a></li>
<li class="toctree-l3"><a class="reference internal" href="gpu.html">GPU computing</a></li>
<li class="toctree-l3"><a class="reference internal" href="parallel.html">Parallel computing</a></li>
<li class="toctree-l3"><a class="reference internal" href="dependency.html">Job dependencies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#detailed-instructions">Detailed instructions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#applications">Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#reference-and-examples">Reference and Examples</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../scicomp/index.html">Scientific computing</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../training/index.html">Training</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../README.html">About these docs</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">Aalto scientific computing</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Triton user guide</a> &raquo;</li>
      
    <li>Serial Jobs</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="https://github.com/AaltoScienceIT/scicomp-docs/blob/master/triton/tut/serial.rst" class="fa fa-github"> Edit on GitHub</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="serial-jobs">
<h1>Serial Jobs<a class="headerlink" href="#serial-jobs" title="Permalink to this headline">¶</a></h1>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">This assumes you have read <a class="reference internal" href="interactive.html"><em>the interactive jobs tutorial</em></a> first.</p>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Triton is a large system that combines many different individual
computers. At the same time, hundreds of people are using it. Thus, we
must use a batch queuing system (slurm) in order to allocate resources.</p>
<p>The queue system takes computation requests from everyone, figures out
the optimal use of resources, and allocates code to nodes. You have to
start your code in a structured way in order for this to work. Our
<a class="reference internal" href="interactive.html"><em>previous tutorial</em></a> showed how to
run things directly from the command line, without any scripting needed.</p>
<p>Now let&#8217;s see how to put these into scripts.  A <strong>shell script</strong> takes
any commands that you might type directly into a shell and automates
them.  The <strong>slurm scripts</strong> that we make in this lesson do do this.
Scripts allow jobs to run asynchronously, in batch, and without human
supervision.</p>
</div>
<div class="section" id="a-basic-script">
<h2>A basic script<a class="headerlink" href="#a-basic-script" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s say we want to run <code class="docutils literal"><span class="pre">echo</span> <span class="pre">'hello</span> <span class="pre">world'</span></code>. We have to tell the
system how to run it.  Here is a simple submission script, put it in a
file called <code class="docutils literal"><span class="pre">hello.slrm</span></code> (you can use the editor nano: <code class="docutils literal"><span class="pre">nano</span>
<span class="pre">hello.slrm</span></code>):</p>
<div class="highlight-python"><div class="highlight"><pre>#!/bin/bash
#SBATCH --time=0-00:05:00    # 5 mins
#SBATCH --mem-per-cpu=500    # 500MB of memory

srun echo &#39;hello, world&#39;
</pre></div>
</div>
<p><strong>Whatever your application or programming language requires, you put
it in the script.</strong></p>
<p>Each <code class="docutils literal"><span class="pre">srun</span></code> is a job step, and appears as a separate row in your
history - which is useful for monitoring.  Then submit it with
<code class="docutils literal"><span class="pre">sbatch</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>$ sbatch hello.slrm
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">You must use <code class="docutils literal"><span class="pre">sbatch</span></code>, not <code class="docutils literal"><span class="pre">bash</span></code> to submit the job
to process the <code class="docutils literal"><span class="pre">#SBATCH</span></code> headers and run in the background.</p>
</div>
<p>This sends it to the queue to wait. Since the time requested is short,
it will probably run on the debug partition, which is reserved for small
test jobs (see below). Let&#8217;s see if it is in the queue:</p>
<p>Checking job status with <code class="docutils literal"><span class="pre">slurm</span> <span class="pre">q</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>$ slurm q
JOBID              PARTITION NAME                  TIME       START_TIME    STATE NODELIST(REASON)
13031249           debug     hello.slrm            0:00              N/A  PENDING (None)
</pre></div>
</div>
<p>Keep rerunning <code class="docutils literal"><span class="pre">slurm</span> <span class="pre">q</span></code> until you see it finish.</p>
<p>You can use <code class="docutils literal"><span class="pre">scancel</span></code> with that jobid to cancel the job before it
finishes.</p>
<p>The output is then saved to <code class="docutils literal"><span class="pre">slurm-13031249.out</span></code> in your current
directory (the number being the job ID).</p>
<div class="section" id="loading-modules-in-scripts">
<h3>Loading modules in scripts<a class="headerlink" href="#loading-modules-in-scripts" title="Permalink to this headline">¶</a></h3>
<p>Need to load modules for your software?  Do it in the batch scripts.
In general, anything you can do from the shell, you can do here:</p>
<div class="highlight-python"><div class="highlight"><pre>#!/bin/bash
#SBATCH --time=0-00:05:00    # 5 mins
#SBATCH --mem-per-cpu=500    # 500MB of memory

module load anaconda
python -V
</pre></div>
</div>
<p><strong>Exercise</strong>: Try the Python version-printing script above.  Try
changing to different modules, <code class="docutils literal"><span class="pre">anaconda2</span></code>, <code class="docutils literal"><span class="pre">Python</span></code>, and others
if you can find them.</p>
</div>
<div class="section" id="job-parameters">
<h3>Job parameters<a class="headerlink" href="#job-parameters" title="Permalink to this headline">¶</a></h3>
<p>As you can see, the above script is limited to 5 minutes and 500MB of
memory. All scripts have to have limits, otherwise they can&#8217;t be
efficiently scheduled. If you exceed the limits, the jobs will be
killed. At least you need to set <code class="docutils literal"><span class="pre">--time</span></code>, <code class="docutils literal"><span class="pre">--mem-per-cpu</span></code> or
<code class="docutils literal"><span class="pre">--mem</span></code>.</p>
<p>See the <a class="reference internal" href="interactive.html"><em>previous tutorial</em></a>, the <a class="reference internal" href="../ref/index.html"><em>reference
page</em></a> or the <a class="reference internal" href="../usage/general.html"><em>details page</em></a> for more information and advanced usage.</p>
<p>The same parameters can be used in</p>
<ul class="simple">
<li>The sbatch script, prefixed by <code class="docutils literal"><span class="pre">#SBATCH</span></code></li>
<li>The <code class="docutils literal"><span class="pre">sbatch</span></code> command line program directly (like <code class="docutils literal"><span class="pre">-p</span> <span class="pre">debug</span></code>
above)</li>
<li><code class="docutils literal"><span class="pre">sinteractive</span></code>/<code class="docutils literal"><span class="pre">srun</span></code> from the command line, which lets you run
programs without a batch script.</li>
</ul>
<p>It is important to note that slurm is a declarative system. You declare
what you need, and slurm handles finding the resources without you
having to worry about details. The more resources you request, the
harder it will be to schedule and the longer you may have to wait. So,
you should ask for enough to make sure your job can complete, but once
you get experience with your code reduce resources to just what is needed.</p>
<p>In general, you don&#8217;t want to go submitting too short jobs (under 5
minutes) because there is a lot of startup, accounting, and scheduling
overhead. If you are testing, short things are fine, but once you get to
bulk production try to have each job take at least 30 minutes if
possible. If you have lots of things to run, combine them into fewer
jobs.</p>
</div>
</div>
<div class="section" id="full-slurm-reference">
<h2>Full slurm reference<a class="headerlink" href="#full-slurm-reference" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">sbatch</span></code></td>
<td>submit a job to queue (see standard options below)</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">srun</span></code></td>
<td>Within a running job script/environment: Run code using the allocated resources (see options below)</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">srun</span></code></td>
<td>On frontend: submit to queue, wait until done, show output. (see options below)</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">sinteractive</span></code></td>
<td>Submit job, wait, provide shell on node for interactive playing (X forwarding works, default partition interactive).  Exit shell when done. (see options below)</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">srun</span> <span class="pre">--pty</span> <span class="pre">bash</span></code></td>
<td>(advanced) Another way to run interactive jobs, no X forwarding but simpler.  Exit shell when done.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">scancel</span></code> <em>&lt;jobid&gt;</em></td>
<td>Cancel a job in queue</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">salloc</span></code></td>
<td>(advanced) Allocate resources from frontend node.  Use <code class="docutils literal"><span class="pre">srun</span></code> to run using those resources, <code class="docutils literal"><span class="pre">exit</span></code> to close shell when done. Read <a class="reference internal" href="../usage/general.html"><em>the description</em></a>! (see options below)</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">scontrol</span></code></td>
<td>View/modify job and slurm configuration</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command</th>
<th class="head">Option</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">sbatch</span></code>/<code class="docutils literal"><span class="pre">srun</span></code>/etc</td>
<td><code class="docutils literal"><span class="pre">-t</span></code>, <code class="docutils literal"><span class="pre">--time=</span></code><em>hh:mm:ss</em></td>
<td><strong>time limit</strong></td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td><code class="docutils literal"><span class="pre">-t,</span> <span class="pre">--time=</span></code><em>dd-hh</em></td>
<td><strong>time limit, days-hours</strong></td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td><code class="docutils literal"><span class="pre">-p,</span> <span class="pre">--partition=</span></code><em>partition</em></td>
<td><strong>job partition.  Usually leave off and things are auto-detected.</strong></td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td><code class="docutils literal"><span class="pre">--mem-per-cpu=</span></code><em>n</em></td>
<td><strong>request n MB of memory per core</strong></td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td><code class="docutils literal"><span class="pre">--mem=</span></code><em>n</em></td>
<td><strong>request n MB memory per node</strong></td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td><code class="docutils literal"><span class="pre">-c</span></code>, <code class="docutils literal"><span class="pre">--cpus-per-task=</span></code><em>n</em></td>
<td><strong>Allocate *n* CPU&#8217;s for each task. For multithreaded jobs. (compare ``&#8211;ntasks``: ``-c`` means the number of cores for each process started.)</strong></td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td><code class="docutils literal"><span class="pre">-N</span></code>, <code class="docutils literal"><span class="pre">--nodes=</span></code><em>n-m</em></td>
<td>allocate minimum of n, maximum of m nodes.</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td><code class="docutils literal"><span class="pre">-n</span></code>, <code class="docutils literal"><span class="pre">--ntasks=</span></code><em>n</em></td>
<td>allocate resources for and start <em>n</em> tasks (one task=one process started, it is up to you to make them communicate. However the main script runs only on first node, the sub-processes run with &#8220;srun&#8221; are run this many times.)</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td><code class="docutils literal"><span class="pre">-J</span></code>, <code class="docutils literal"><span class="pre">--job-name=</span></code><em>name</em></td>
<td>short job name</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td><code class="docutils literal"><span class="pre">-o</span></code> <em>output</em></td>
<td>print output into file <em>output</em></td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td><code class="docutils literal"><span class="pre">-e</span></code> <em>error</em></td>
<td>print errors into file <em>error</em></td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td><code class="docutils literal"><span class="pre">--exclusive</span></code></td>
<td>allocate exclusive access to nodes.  For large parallel jobs.</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td><code class="docutils literal"><span class="pre">--constraint=</span></code><em>feature</em></td>
<td>request <em>feature</em> (see <code class="docutils literal"><span class="pre">slurm</span> <span class="pre">features</span></code> for the current list of configured features, or Arch under the <a class="reference internal" href="../ref/index.html#hardware-list"><span>hardware list</span></a>).  Multiple with <code class="docutils literal"><span class="pre">--constraint=&quot;hsw|skl&quot;</span></code>.</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td><code class="docutils literal"><span class="pre">--array=</span></code><em>0-5,7,10-15</em></td>
<td>Run job multiple times, use variable <code class="docutils literal"><span class="pre">$SLURM_ARRAY_TASK_ID</span></code> to adjust parameters.</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td><code class="docutils literal"><span class="pre">--gres=gpu</span></code></td>
<td>request a GPU, or <code class="docutils literal"><span class="pre">--gres=gpu:</span></code><em>n</em> for multiple</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td><code class="docutils literal"><span class="pre">--gres=spindle</span></code></td>
<td>request nodes that have disks, <code class="docutils literal"><span class="pre">spindle:</span></code><em>n</em>, for a certain number of RAID0 disks</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td><code class="docutils literal"><span class="pre">--mail-type=</span></code><em>type</em></td>
<td>notify of events: <code class="docutils literal"><span class="pre">BEGIN</span></code>, <code class="docutils literal"><span class="pre">END</span></code>, <code class="docutils literal"><span class="pre">FAIL</span></code>, <code class="docutils literal"><span class="pre">ALL</span></code>, <code class="docutils literal"><span class="pre">REQUEUE</span></code> (not on triton) or <code class="docutils literal"><span class="pre">ALL.</span></code> MUST BE used with <code class="docutils literal"><span class="pre">--mail-user=</span></code> only</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td><code class="docutils literal"><span class="pre">--mail-user=</span></code><em>your&#64;email</em></td>
<td>whome to send the email</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">srun</span></code></td>
<td><code class="docutils literal"><span class="pre">-N</span></code> <em>&lt;N_nodes&gt;</em> hostname</td>
<td>Print allocated nodes (from within script)</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="status-of-the-jobs">
<h2>Status of the jobs<a class="headerlink" href="#status-of-the-jobs" title="Permalink to this headline">¶</a></h2>
<p>Once you submit jobs, it goes into a queue. You need to be able to see
the status of jobs. There are commands to do this.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command</th>
<th class="head">&nbsp;</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>slurm j &lt;jobid&gt;</td>
<td>Status on single job (still running)</td>
</tr>
<tr class="row-odd"><td>slurm history [2hours|5days|...]</td>
<td>Info on completed jobs, including
mem/cpu usage.</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">slurm</span> <span class="pre">q</span></code> ; <code class="docutils literal"><span class="pre">slurm</span> <span class="pre">qq</span></code></td>
<td>Status of your queued jobs (long/short)</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">slurm</span> <span class="pre">partitions</span></code></td>
<td>Overview of partitions (A/I/O/T=active,idle,other,total)</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">slurm</span> <span class="pre">cpus</span></code> <em>&lt;partition&gt;</em></td>
<td>list free CPUs in a partition</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">slurm</span> <span class="pre">history</span></code> <em>[1day,2hour,...]</em></td>
<td>Show status of recent jobs</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">seff</span></code> <em>&lt;jobid&gt;</em></td>
<td>Show percent of mem/CPU used in job</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">slurm</span> <span class="pre">j</span></code> <em>&lt;jobid&gt;</em></td>
<td>Job details (only while running)</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">slurm</span> <span class="pre">s</span></code> ; <code class="docutils literal"><span class="pre">slurm</span> <span class="pre">ss</span></code> <em>&lt;partition&gt;</em></td>
<td>Show status of all jobs</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">sacct</span></code></td>
<td>Full history information (advanced, needs args)</td>
</tr>
</tbody>
</table>
<p><strong>Full slurm command help:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>$ slurm

Show or watch job queue:
 slurm [watch] queue     show own jobs
 slurm [watch] q   show user&#39;s jobs
 slurm [watch] quick     show quick overview of own jobs
 slurm [watch] shorter   sort and compact entire queue by job size
 slurm [watch] short     sort and compact entire queue by priority
 slurm [watch] full      show everything
 slurm [w] [q|qq|ss|s|f] shorthands for above!
 slurm qos               show job service classes
 slurm top [queue|all]   show summary of active users
Show detailed information about jobs:
 slurm prio [all|short]  show priority components
 slurm j|job      show everything else
 slurm steps      show memory usage of running srun job steps
Show usage and fair-share values from accounting database:
 slurm h|history   show jobs finished since, e.g. &quot;1day&quot; (default)
 slurm shares
Show nodes and resources in the cluster:
 slurm p|partitions      all partitions
 slurm n|nodes           all cluster nodes
 slurm c|cpus            total cpu cores in use
 slurm cpus   cores available to partition, allocated and free
 slurm cpus jobs         cores/memory reserved by running jobs
 slurm cpus queue        cores/memory required by pending jobs
 slurm features          List features and GRES

Examples:
 slurm q
 slurm watch shorter
 slurm cpus batch
 slurm history 3hours
</pre></div>
</div>
<p><strong>Other advanced</strong> commands (many require lots of parameters to be
useful):</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">squeue</span></code></td>
<td>Full info on queues</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">sinfo</span></code></td>
<td>Advanced info on partitions</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">slurm</span> <span class="pre">nodes</span></code></td>
<td>List all nodes</td>
</tr>
</tbody>
</table>
<p>See the full list of status commands on the <a class="reference internal" href="../ref/index.html"><em>reference page</em></a>.</p>
</div>
<div class="section" id="partitions">
<h2>Partitions<a class="headerlink" href="#partitions" title="Permalink to this headline">¶</a></h2>
<p>There are different <em>partitions</em>, which have different limits. The
&#8220;debug&#8221; partition is for short debugging, so is designed to always be
available. The &#8220;batch&#8221; partition is designed for all the normal long
jobs. There are also partitions for GPUs, huge memory nodes, interactive
shells, and so on. Most of the time, you should leave the partition off,
and slurm will use all possible partitions. You can specify your
partitions with <code class="docutils literal"><span class="pre">-p</span> <span class="pre">PARTITION_NAME</span></code> to whatever command you are
running, which is mainly needed if you want to force interactive or a
test partition. The available partitions are listed on the
reference page.</p>
<p>You can see the partitions in the <a class="reference internal" href="../ref/index.html"><em>quick
reference</em></a>.</p>
</div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Basics<ol class="loweralpha">
<li>Submit a batch job that just runs <code class="docutils literal"><span class="pre">hostname</span></code>.</li>
<li>Set time to 1 hour and 15 minutes, memory to 500MB.</li>
<li>Change the job&#8217;s name and output file.</li>
<li>Monitor the job with <code class="docutils literal"><span class="pre">slurm</span> <span class="pre">watch</span> <span class="pre">queue</span></code>.</li>
<li>Check the output.  Does it match <code class="docutils literal"><span class="pre">slurm</span> <span class="pre">history</span></code>?</li>
</ol>
</li>
<li>Create a simple batch script using <code class="docutils literal"><span class="pre">pi.py</span></code> based on the pi
calculation of the <a class="reference internal" href="interactive.html"><em>interactive job tutorial exercises</em></a>.  Create multiple job steps (separate <code class="docutils literal"><span class="pre">srun</span></code>
lines), each of which runs <code class="docutils literal"><span class="pre">pi.py</span></code> with a greater and greater
number of tries.  How does this appear in <code class="docutils literal"><span class="pre">slurm</span> <span class="pre">history</span></code>.  When
would you use extra <code class="docutils literal"><span class="pre">srun</span></code> commands, and when not?</li>
<li>Create a batch script which does nothing (or some pointless
operation for a while), for example <code class="docutils literal"><span class="pre">sleep</span> <span class="pre">300</span></code> (waits for 300
seconds) in the <code class="docutils literal"><span class="pre">debug</span></code> partition.  Check the queue to see when
it starts running.  Then, cancel the job.  What output is produced?</li>
<li>What happens if you submit a batch script with <code class="docutils literal"><span class="pre">bash</span></code> instead of
<code class="docutils literal"><span class="pre">sbatch</span></code>?  Does it appear to run?  Does it use all the Slurm
options?</li>
</ol>
<ol class="arabic simple" start="4">
<li>(Advanced) Create a batch script that runs in another language.
Does it run?  What are some of the advantages and problems here?</li>
</ol>
</div>
<div class="section" id="next-steps">
<h2>Next steps<a class="headerlink" href="#next-steps" title="Permalink to this headline">¶</a></h2>
<p>There is a full description of <a class="reference internal" href="../usage/general.html"><em>running jobs on
Triton</em></a>, and the <a class="reference internal" href="../ref/index.html"><em>reference
page</em></a> lists many useful commands.</p>
<p>Running multiple instances of a <code class="docutils literal"><span class="pre">sbatch</span></code> script is easier with
<a class="reference internal" href="array.html"><em>array jobs</em></a>.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="array.html" class="btn btn-neutral float-right" title="Array jobs" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="interactive.html" class="btn btn-neutral" title="Interactive jobs" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Aalto Science-IT.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../_static/redirect-to-https.js"></script>
      <script type="text/javascript" src="https://users.aalto.fi/~darstr1/minipres-stable.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>